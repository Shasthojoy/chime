{% extends "base.html" %}
{% block title %}Activities{% endblock %}
{% set template_name = 'activities-list' %}
{% block body_class %}{{template_name}}{% endblock %}

{% block content %}
    <!-- template name: {{template_name}} -->
    <div class="activities-list__main grid col__flex">
      <div class="current-tasks grid__item width-two-thirds">
        <h2 class="current-tasks__title">Current Activities</h2>
        {% if activities | length == 0 %}

          <p class="current-tasks__empty-description">Doesn't look like anyone's working on anything at the moment. You should hop to it!</p>
        {% else %}
          <p class="current-tasks__description">Work that's already underway by you and your colleagues.</p>
          <ul class="current-tasks__list">
          {% for activity in activities %}
           <li class="current-task">
            <p class="current-task__title"><a href="{{ activity.task_root_path }}">{{ activity.task_description }}{% if activity.task_beneficiary %} for {{ activity.task_beneficiary }}{% endif %}</a></p>
            <div class="current-task__details row">
              <p class="current-task__author row__left">Last edited by {{ activity.last_edited_email }}</p>
              <div class="current-task__actions row__right toolbar--right">
                  <form action="/update" method="POST" class="toolbar__item">
                  {% if activity.review_authorized %}
                    {% if activity.review_state == 'unreviewed edits' %}
                    <input class="toolbar__item button button--orange" type="submit" name="request_feedback" value="Request Feedback">
                    {% elif activity.review_state == 'feedback requested' %}
                    <input class="toolbar__item button button--green" type="submit" name="endorse_edits" value="Looks Good!">
                    {% elif activity.review_state == 'edits endorsed' %}
                    <input class="toolbar__item button button--blue" type="submit" name="merge" value="Publish">
                    {% endif %}
                  {% endif %}
                    <input class="toolbar__item button button--red" type="submit" name="abandon" value="Delete">
                    <input type="hidden" name="branch" value="{{activity.safe_branch}}">
                  </form>
                </div>
              </div>
            </li>
          {% endfor %}
          </ul>
         {% endif %}
        </div>
        <div class="new-task grid__item width-one-third end-row">
          <h2 class="new-task__title">Start a new activity</h2>
          <p class="new-task__description">Describe the new activity in terms of a user need.</p>
          <form action="/start" method="POST" class="new-task__form">
            <p>I am<input name="task_description" placeholder="clarifying the permitting application process" type="text" class="need" /> for <input type="text" name="task_beneficiary" placeholder="business owners" /></p>
            <p><button type="submit" class="create button button--green">Let's go!</button></p>
          </form>  
        </div>
    </div>
{% endblock %}


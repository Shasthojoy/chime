{% extends "base.html" %}

{% set template_name = 'articles-list' %}
{% block body_class %}{{template_name}}{% endblock %}

{% set breadcrumb_items = [{'name': 'Activites', 'url': '/'}] %}

{% block title %}Browse{% endblock %}

{% block content %}

<!-- task: {% if task_description %}{{task_description}}{% elif task %}{{task}}{% else %}{{name}}{% endif %} -->
<!-- beneficiary: {% if task_beneficiary %}{{task_beneficiary}}{% endif %} -->
<!-- template name: {{template_name}} -->
{% set icon_class_lookup = {'folder': 'fa fa-folder-o', 'file': 'fa fa-file-text-o', 'category': 'fa fa-folder', 'article': 'fa fa-file-text'} %}
<div class="articles-list__main grid col__flex">
    {% for column in dir_columns %}
    {% if loop.index != 1 or (loop.index == 1 and dir_columns|length == 1) %}
    <div class="dir grid__item {% if loop.index == 4 %}width-one-half end-row{% else %}width-one-fourth{% endif %}">
      {% if loop.index == 2 %}
      <h2>Categories</h2>
      <div class="selection-box box-add-file-folder">
        <form action="." method="POST" class="form-one-line">
            <input class="form-one-line__input" name="request_path" placeholder="Add Category" type="text" />
            <input name="create_what" value="category" type="hidden" />
            <input name="create_path" value="{{column['base_path']}}" type="hidden" />
            <input class="form-one-line__submit button" name="action" type="submit" value="Create" />
        </form>
      </div>
      {% elif loop.index == 3 %}
      <h2>Subcategories</h2>
      <div class="selection-box box-add-file-folder">
        <form action="." method="POST" class="form-one-line">
            <input class="form-one-line__input" name="request_path" placeholder="Add Subcategory" type="text" />
            <input name="create_what" value="category" type="hidden" />
            <input name="create_path" value="{{column['base_path']}}" type="hidden" />
            <input class="form-one-line__submit button" name="action" type="submit" value="Create" />
        </form>
      </div>
      {% elif loop.index == 4 %}
      <h2>Articles</h2>
      <div class="selection-box box-add-file-folder">
        <form action="." method="POST" class="form-one-line">
            <input class="form-one-line__input" name="request_path" placeholder="Add Article" type="text" />
            <input name="create_what" value="article" type="hidden" />
            <input name="create_path" value="{{column['base_path']}}" type="hidden" />
            <input class="form-one-line__submit button" name="action" type="submit" value="Create" />
        </form>
      </div>
      {% endif %}
      <ul class="dir">
        {% for file in column['files'] %}
         <!-- file type: {{file['display_type']}}, file name: {{file['name']}}, file title: {{file['title']}} -->
         <li class="dir-item row {% if file['selected'] == True %}is-selected{% endif %}">
            <a class="dir-item__name {{file['display_type']}} row__left" href="{{file['edit_path']}}"><span class="{{icon_class_lookup[file['display_type']]}}"></span>{{ file['title'] }}</a>
            <div class="dir-item__actions toolbar--right row__right">
            <form action="." method="POST">
              <input name="request_path" value="{{file['file_path']}}" type="hidden">
              <button name="action" type="submit" value="delete" style="background:none!important; border:none; padding:0!important; margin:0!important"><span class="fa fa-trash"></span></button>
            </form>
              <a href="#"><span class="fa fa-pencil"></span></a>
            </div>
          </li>
        {% endfor %}   
      </ul>
    </div>
    {% endif %}
    {% endfor %}
</div>
{% endblock %}

